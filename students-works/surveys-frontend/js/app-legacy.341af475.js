(function(){"use strict";var t={9813:function(t,e,s){s(6992),s(8674),s(9601),s(7727);var a=s(8935),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("nav",{staticClass:"navbar navbar-expand navbar-light bg-white shadow"},[s("div",{staticClass:"container"},[s("router-link",{staticClass:"navbar-brand",attrs:{to:"/"}},[t._v(" ToU Surveys ")]),t.user?s("div",[s("ul",{staticClass:"navbar-nav ms-auto"},[s("li",{staticClass:"nav-item dropdown"},[s("a",{staticClass:"nav-link dropdown-toggle",attrs:{id:"navbarDropdown",href:"#",role:"button","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[t._v(" "+t._s(t.user.name)+" ")]),s("div",{staticClass:"dropdown-menu dropdown-menu-end",attrs:{"aria-labelledby":"navbarDropdown"}},[s("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.logout.apply(null,arguments)}}},[t._v(" Выход ")])])])])]):t._e()],1)]),s("router-view")],1)},i=[],r=s(4665),o={computed:(0,r.Se)(["user"]),methods:{logout:function(){this.$store.commit("logout"),this.$router.push("/login")}},created:function(){this.$store.commit("restoreUser")}},l=o,c=s(1001),u=(0,c.Z)(l,n,i,!1,null,null,null),d=u.exports,m=s(563);(0,m.z)("".concat("/surveys-frontend/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});s(6699),s(8309);var f=s(2809),v=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"py-5"},[s("div",{staticClass:"container"},[s("div",{staticClass:"\n        d-flex\n        flex-column flex-sm-row\n        justify-content-between\n        align-items-center\n        mb-3\n      "},[s("h2",{staticClass:"mb-4"},[t._v("Последние опросы")]),s("router-link",{staticClass:"btn btn-primary mb-4",attrs:{to:"/create"}},[t._v("Создать новый")])],1),t.loading?s("div",{staticClass:"d-flex justify-content-center py-4"},[s("div",{staticClass:"loader"})]):t.questions.length?t._e():s("div",{staticClass:"h4 py-4 text-center"},[t._v("Пока что ничего...")]),t._l(t.questions,(function(e){return s("div",{key:e.id,staticClass:"card mb-4 shadow"},[s("div",{staticClass:"card-body"},[s("router-link",{staticClass:"h4 text-decoration-none",attrs:{to:"/"+(e.has_answers?"results":"question")+"/"+e.id}},[t._v(t._s(e.text))]),s("div",{staticClass:"d-sm-flex justify-content-between mt-4"},[s("div",{staticClass:"text-secondary"},[s("i",{staticClass:"far fa-user-circle"}),t._v(" "+t._s(e.user.name)+" ")]),e.has_answers?s("div",{staticClass:"text-success mt-2 mt-sm-0"},[s("i",{staticClass:"fas fa-check"}),t._v(" Вы ответили ")]):t._e()]),s("hr"),s("div",{staticClass:"d-flex justify-content-between text-secondary"},[s("small",[s("i",{staticClass:"far fa-calendar"}),t._v(" "+t._s(new Date(e.created_at).toLocaleString()))]),s("small",[s("i",{staticClass:"far fa-hand"}),t._v(" "+t._s(e.answers_count)+" ответов")])])],1)])})),t.links.length>3?s("nav",{staticClass:"pt-4"},[s("ul",{staticClass:"pagination justify-content-center"},t._l(t.links,(function(e,a){return s("li",{key:a,staticClass:"page-item",class:{disabled:!e.url,active:e.active}},[s("a",{staticClass:"page-link",attrs:{href:"#"},domProps:{innerHTML:t._s(e.label)},on:{click:function(s){return s.preventDefault(),t.loadQuestions(e.url)}}})])})),0)]):t._e()],2)])},p=[],h=(s(1539),{name:"HomeView",data:function(){return{questions:[],links:[],loading:!0}},computed:(0,r.Se)(["user"]),methods:{loadQuestions:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"https://students.itschool.tou.edu.kz/surveys-backend/api/questions";this.loading=!0,fetch(e,{headers:{Authorization:"Bearer ".concat(this.user.api_token)}}).then((function(t){return t.json()})).then((function(e){t.questions=e.data,t.links=e.meta.links,t.loading=!1}))}},created:function(){this.loadQuestions()}}),g=h,C=(0,c.Z)(g,v,p,!1,null,null,null),b=C.exports,_=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"py-5"},[s("div",{staticClass:"container pt-5"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-lg-6 col-sm-8"},[s("div",{staticClass:"card shadow"},[s("form",{staticClass:"card-body p-4",attrs:{action:"#"},on:{submit:function(e){return e.preventDefault(),t.login.apply(null,arguments)}}},[s("h2",{staticClass:"mb-5 text-center"},[t._v("Авторизация")]),s("div",{staticClass:"mb-4"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"form-control",class:{"is-invalid":t.errors.email||t.errors.error},attrs:{type:"email",placeholder:"Ваш email"},domProps:{value:t.form.email},on:{input:function(e){e.target.composing||t.$set(t.form,"email",e.target.value)}}}),s("span",{staticClass:"invalid-feedback"},[t._v(t._s(t.errors.email||t.errors.error))])]),s("div",{staticClass:"mb-4"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password,expression:"form.password"}],staticClass:"form-control",class:{"is-invalid":t.errors.password},attrs:{type:"password",placeholder:"Ваш пароль"},domProps:{value:t.form.password},on:{input:function(e){e.target.composing||t.$set(t.form,"password",e.target.value)}}}),s("span",{staticClass:"invalid-feedback"},[t._v(t._s(t.errors.password))])]),s("button",{staticClass:"btn w-100 mb-3",class:{"btn-primary":!t.loading,"btn-light":t.loading}},[t._v(" "+t._s(t.loading?"Вход...":"Войти")+" ")]),s("div",{staticClass:"text-center"},[s("small",[t._v(" Нет аккаунта? "),s("router-link",{attrs:{to:"/register"}},[t._v("Регистрация")])],1)])])])])])])])},y=[],w=(s(8862),{name:"LoginView",data:function(){return{form:{email:"",password:""},errors:{},loading:!1}},methods:{login:function(){var t=this;this.loading=!0,this.errors={},fetch("https://students.itschool.tou.edu.kz/surveys-backend/api/login",{method:"POST",body:JSON.stringify(this.form),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){e.errors?t.errors=e.errors:(t.$store.commit("login",e.data),t.$router.push("/")),t.loading=!1}))}}}),x=w,k=(0,c.Z)(x,_,y,!1,null,null,null),q=k.exports,j=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"py-5"},[s("div",{staticClass:"container pt-5"},[s("div",{staticClass:"row justify-content-center"},[s("div",{staticClass:"col-lg-6 col-sm-8"},[s("div",{staticClass:"card shadow"},[s("form",{staticClass:"card-body p-4",attrs:{action:"index.html"},on:{submit:function(e){return e.preventDefault(),t.register.apply(null,arguments)}}},[s("h2",{staticClass:"mb-5 text-center"},[t._v("Регистрация")]),s("div",{staticClass:"mb-4"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"form-control",class:{"is-invalid":t.errors.name},attrs:{type:"name",placeholder:"Ваше имя"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}}),s("span",{staticClass:"invalid-feedback"},[t._v(t._s(t.errors.name))])]),s("div",{staticClass:"mb-4"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"form-control",class:{"is-invalid":t.errors.email},attrs:{type:"email",placeholder:"Ваш email"},domProps:{value:t.form.email},on:{input:function(e){e.target.composing||t.$set(t.form,"email",e.target.value)}}}),s("span",{staticClass:"invalid-feedback"},[t._v(t._s(t.errors.email))])]),s("div",{staticClass:"mb-4"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password,expression:"form.password"}],staticClass:"form-control",class:{"is-invalid":t.errors.password},attrs:{type:"password",placeholder:"Придумайте пароль"},domProps:{value:t.form.password},on:{input:function(e){e.target.composing||t.$set(t.form,"password",e.target.value)}}}),s("span",{staticClass:"invalid-feedback"},[t._v(t._s(t.errors.password))])]),s("button",{staticClass:"btn w-100 mb-3",class:{"btn-primary":!t.loading,"btn-light":t.loading}},[t._v(" "+t._s(t.loading?"Проверка...":"Создать аккаунт")+" ")]),s("div",{staticClass:"text-center"},[s("small",[t._v(" Уже зарегистрированы? "),s("router-link",{attrs:{to:"/login"}},[t._v("Войти")])],1)])])])])])])])},S=[],$={name:"RegisterView",data:function(){return{form:{name:"",email:"",password:""},errors:{},loading:!1}},methods:{register:function(){var t=this;this.loading=!0,this.errors={},fetch("https://students.itschool.tou.edu.kz/surveys-backend/api/register",{method:"POST",body:JSON.stringify(this.form),headers:{"Content-Type":"application/json"}}).then((function(t){return t.json()})).then((function(e){e.errors?t.errors=e.errors:(t.$store.commit("login",e.data),t.$router.push("/")),t.loading=!1}))}}},O=$,N=(0,c.Z)(O,j,S,!1,null,null,null),P=N.exports,Z=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"py-5"},[s("div",{staticClass:"container"},[t.question?s("div",{staticClass:"card shadow"},[s("form",{staticClass:"card-body p-4",attrs:{action:"#"},on:{submit:function(e){return e.preventDefault(),t.send.apply(null,arguments)}}},[s("div",{staticClass:"d-sm-flex align-items-center justify-content-between"},[s("h2",{staticClass:"mb-3 mb-sm-0"},[t._v(t._s(t.question.text))]),s("small",{staticClass:"text-secondary"},[s("i",{staticClass:"far fa-user-circle"}),t._v(" "+t._s(t.question.user.name)+", "+t._s(new Date(t.question.created_at).toLocaleString()))])]),s("hr",{staticClass:"my-4"}),t._l(t.question.variants,(function(e){return s("label",{key:e.id,staticClass:"mb-3 d-block"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.variant_id,expression:"variant_id"}],staticClass:"me-2",attrs:{type:"radio",name:"variant_id"},domProps:{value:e.id,checked:t._q(t.variant_id,e.id)},on:{change:function(s){t.variant_id=e.id}}}),t._v(" "+t._s(e.text)+" ")])})),s("hr"),s("div",{staticClass:"d-flex justify-content-between align-items-center"},[s("div",{staticClass:"d-flex align-items-center"},[s("button",{staticClass:"btn btn-primary",attrs:{disabled:!t.variant_id}},[t._v("Ответить")]),t.loading?s("div",{staticClass:"loader-sm ms-3"}):t._e()]),s("small",{staticClass:"text-secondary"},[s("i",{staticClass:"far fa-hand"}),t._v(" "+t._s(t.question.answers_count)+" ответов")])])],2)]):t._e()])])},T=[],z={name:"QuestionView",props:["id"],computed:(0,r.Se)(["user"]),data:function(){return{question:null,variant_id:null,loading:!1}},methods:{loadQuestion:function(){var t=this;fetch("https://students.itschool.tou.edu.kz/surveys-backend/api/questions/".concat(this.id),{headers:{Authorization:"Bearer ".concat(this.user.api_token)}}).then((function(t){return t.json()})).then((function(e){return t.question=e.data}))},send:function(){var t=this;this.loading=!0,fetch("https://students.itschool.tou.edu.kz/surveys-backend/api/questions/".concat(this.id,"/answer"),{method:"POST",body:JSON.stringify({variant_id:this.variant_id}),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.user.api_token)}}).then((function(e){e.ok&&t.$router.push("/results/".concat(t.id)),t.loading=!1}))}},created:function(){this.loadQuestion()}},D=z,A=(0,c.Z)(D,Z,T,!1,null,null,null),E=A.exports,V=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"py-5"},[s("div",{staticClass:"container"},[t.loading?s("div",{staticClass:"d-flex justify-content-center py-4"},[s("div",{staticClass:"loader"})]):t._e(),t.question?s("div",{staticClass:"card shadow"},[s("div",{staticClass:"card-body p-4"},[s("div",{staticClass:"d-sm-flex align-items-center justify-content-between"},[s("h2",{staticClass:"mb-3 mb-sm-0"},[t._v(t._s(t.question.text))]),s("small",{staticClass:"text-secondary"},[s("i",{staticClass:"far fa-user-circle"}),t._v(" "+t._s(t.question.user.name)+", "+t._s(new Date(t.question.created_at).toLocaleString()))])]),s("hr",{staticClass:"my-4"}),t._l(t.question.variants,(function(e){return s("div",{key:e.id,staticClass:"mb-4"},[s("div",{staticClass:"mb-2"},[t._v(t._s(e.text)+" - "+t._s(t.percent(e.users.length))+"%")]),s("div",{staticClass:"progress"},[s("div",{staticClass:"progress-bar",style:{width:t.percent(e.users.length)+"%"},attrs:{role:"progressbar","aria-valuenow":t.percent(e.users.length),"aria-valuemin":"0","aria-valuemax":"100"}})]),s("small",{staticClass:"text-secondary"},[t._v(" "+t._s(e.users.slice(0,3).map((function(t){return t.name})).join(", "))+" "),e.users.length>3?s("span",[t._v("и еще "+t._s(e.users.length-3))]):t._e()])])})),s("hr"),s("router-link",{staticClass:"btn btn-sm btn-light",attrs:{to:"/question/"+t.id}},[s("i",{staticClass:"fas fa-pencil"}),t._v(" Изменить свой ответ ")])],2)]):t._e()])])},B=[],J=s(3019),Q=(s(2222),{name:"ResultsView",props:["id"],computed:(0,J.Z)((0,J.Z)({},(0,r.Se)(["user"])),{},{allAnswers:function(){return this.question.variants.reduce((function(t,e){return t.concat(e.users)}),[])}}),data:function(){return{question:null,loading:!0}},methods:{percent:function(t){return t?Math.round(t/this.allAnswers.length*100):0},loadResults:function(){var t=this;fetch("https://students.itschool.tou.edu.kz/surveys-backend/api/questions/".concat(this.id,"/results"),{headers:{Authorization:"Bearer ".concat(this.user.api_token)}}).then((function(t){return t.json()})).then((function(e){e.errors?t.$router.push("/question/".concat(t.id)):t.question=e.data,t.loading=!1}))}},created:function(){this.loadResults()}}),I=Q,L=(0,c.Z)(I,V,B,!1,null,null,null),R=L.exports,F=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"py-5"},[s("div",{staticClass:"container"},[s("div",{staticClass:"card shadow"},[s("form",{staticClass:"card-body p-4",attrs:{action:"#"},on:{submit:function(e){return e.preventDefault(),t.send.apply(null,arguments)}}},[s("h2",{staticClass:"mb-4"},[t._v("Новый опрос")]),s("div",{staticClass:"mb-4"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.question.text,expression:"question.text"}],staticClass:"form-control",class:{"is-invalid":t.errors.text},attrs:{placeholder:"Текст вопроса"},domProps:{value:t.question.text},on:{input:function(e){e.target.composing||t.$set(t.question,"text",e.target.value)}}}),s("span",{staticClass:"invalid-feedback"},[t._v("This field is required")])]),t._l(t.question.variants,(function(e,a){return s("div",{key:a,staticClass:"mb-4 row"},[s("div",{staticClass:"col"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"variant.text"}],staticClass:"form-control",class:{"is-invalid":t.errors["variants."+a+".text"]},attrs:{type:"text",placeholder:"Вариант #"+(a+1)},domProps:{value:e.text},on:{input:function(s){s.target.composing||t.$set(e,"text",s.target.value)}}}),s("span",{staticClass:"invalid-feedback"},[t._v("This field is required")])]),s("div",{staticClass:"col-auto"},[s("button",{staticClass:"btn btn-light",attrs:{type:"button"},on:{click:function(e){return t.deleteVariant(a)}}},[s("i",{staticClass:"fas fa-trash-alt"})])])])})),s("a",{staticClass:"btn btn-light",attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.addVariant.apply(null,arguments)}}},[s("i",{staticClass:"fas fa-add"}),t._v(" Добавить вариант ответа ")]),s("hr"),s("div",{staticClass:"d-flex justify-content-end align-items-center"},[t.loading?s("div",{staticClass:"loader-sm me-3"}):t._e(),s("button",{staticClass:"btn btn-primary"},[t._v("Опубликовать")])])],2)])])])},M=[],U=(s(561),{name:"CreateView",data:function(){return{question:{variants:[{text:""}]},errors:{},loading:!1}},computed:(0,r.Se)(["user"]),methods:{addVariant:function(){this.question.variants.push({text:""})},deleteVariant:function(t){this.question.variants.splice(t,1)},send:function(){var t=this;this.loading=!0,this.errors={},fetch("https://students.itschool.tou.edu.kz/surveys-backend/api/questions",{method:"POST",body:JSON.stringify(this.question),headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.user.api_token)}}).then((function(e){e.ok?t.$router.push("/"):e.json().then((function(e){return t.errors=e.errors})),t.loading=!1}))}}}),H=U,G=(0,c.Z)(H,F,M,!1,null,null,null),K=G.exports;a.Z.use(f.Z);var W=[{path:"/",name:"home",component:b},{path:"/login",name:"login",component:q},{path:"/register",name:"register",component:P},{path:"/question/:id",name:"question",component:E,props:!0},{path:"/results/:id",name:"results",component:R,props:!0},{path:"/create",name:"create",component:K}],X=new f.Z({mode:"history",base:"/surveys-frontend/",routes:W});X.beforeEach((function(t,e,s){localStorage.getItem("user")||["login","register"].includes(t.name)?s():s({name:"login"})}));var Y=X;a.Z.use(r.ZP);var tt=new r.ZP.Store({state:{user:null},getters:{user:function(t){return t.user}},mutations:{login:function(t,e){t.user=e,localStorage.setItem("user",JSON.stringify(e))},logout:function(t){t.user=null,localStorage.removeItem("user")},restoreUser:function(t){localStorage.getItem("user")&&(t.user=JSON.parse(localStorage.getItem("user")))}},actions:{},modules:{}});a.Z.config.productionTip=!1,new a.Z({router:Y,store:tt,render:function(t){return t(d)}}).$mount("#app")}},e={};function s(a){var n=e[a];if(void 0!==n)return n.exports;var i=e[a]={exports:{}};return t[a](i,i.exports,s),i.exports}s.m=t,function(){var t=[];s.O=function(e,a,n,i){if(!a){var r=1/0;for(u=0;u<t.length;u++){a=t[u][0],n=t[u][1],i=t[u][2];for(var o=!0,l=0;l<a.length;l++)(!1&i||r>=i)&&Object.keys(s.O).every((function(t){return s.O[t](a[l])}))?a.splice(l--,1):(o=!1,i<r&&(r=i));if(o){t.splice(u--,1);var c=n();void 0!==c&&(e=c)}}return e}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[a,n,i]}}(),function(){s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,{a:e}),e}}(),function(){s.d=function(t,e){for(var a in e)s.o(e,a)&&!s.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={143:0};s.O.j=function(e){return 0===t[e]};var e=function(e,a){var n,i,r=a[0],o=a[1],l=a[2],c=0;if(r.some((function(e){return 0!==t[e]}))){for(n in o)s.o(o,n)&&(s.m[n]=o[n]);if(l)var u=l(s)}for(e&&e(a);c<r.length;c++)i=r[c],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(u)},a=self["webpackChunkdev_surveys_frontend"]=self["webpackChunkdev_surveys_frontend"]||[];a.forEach(e.bind(null,0)),a.push=e.bind(null,a.push.bind(a))}();var a=s.O(void 0,[998],(function(){return s(9813)}));a=s.O(a)})();
//# sourceMappingURL=app-legacy.341af475.js.map
(function(){"use strict";var t={9813:function(t,s,e){var a=e(8935),n=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"app"}},[e("nav",{staticClass:"navbar navbar-expand navbar-light bg-white shadow"},[e("div",{staticClass:"container"},[e("router-link",{staticClass:"navbar-brand",attrs:{to:"/"}},[t._v(" ToU Surveys ")]),t.user?e("div",[e("ul",{staticClass:"navbar-nav ms-auto"},[e("li",{staticClass:"nav-item dropdown"},[e("a",{staticClass:"nav-link dropdown-toggle",attrs:{id:"navbarDropdown",href:"#",role:"button","data-bs-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[t._v(" "+t._s(t.user.name)+" ")]),e("div",{staticClass:"dropdown-menu dropdown-menu-end",attrs:{"aria-labelledby":"navbarDropdown"}},[e("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),t.logout.apply(null,arguments)}}},[t._v(" Выход ")])])])])]):t._e()],1)]),e("router-view")],1)},i=[],r=e(4665),o={computed:(0,r.Se)(["user"]),methods:{logout:function(){this.$store.commit("logout"),this.$router.push("/login")}},created(){this.$store.commit("restoreUser")}},l=o,c=e(1001),u=(0,c.Z)(l,n,i,!1,null,null,null),d=u.exports,m=e(563);(0,m.z)("/surveys-frontend/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}});var p=e(2809),v=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("main",{staticClass:"py-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"\n        d-flex\n        flex-column flex-sm-row\n        justify-content-between\n        align-items-center\n        mb-3\n      "},[e("h2",{staticClass:"mb-4"},[t._v("Последние опросы")]),e("router-link",{staticClass:"btn btn-primary mb-4",attrs:{to:"/create"}},[t._v("Создать новый")])],1),t.loading?e("div",{staticClass:"d-flex justify-content-center py-4"},[e("div",{staticClass:"loader"})]):t.questions.length?t._e():e("div",{staticClass:"h4 py-4 text-center"},[t._v("Пока что ничего...")]),t._l(t.questions,(function(s){return e("div",{key:s.id,staticClass:"card mb-4 shadow"},[e("div",{staticClass:"card-body"},[e("router-link",{staticClass:"h4 text-decoration-none",attrs:{to:"/"+(s.has_answers?"results":"question")+"/"+s.id}},[t._v(t._s(s.text))]),e("div",{staticClass:"d-sm-flex justify-content-between mt-4"},[e("div",{staticClass:"text-secondary"},[e("i",{staticClass:"far fa-user-circle"}),t._v(" "+t._s(s.user.name)+" ")]),s.has_answers?e("div",{staticClass:"text-success mt-2 mt-sm-0"},[e("i",{staticClass:"fas fa-check"}),t._v(" Вы ответили ")]):t._e()]),e("hr"),e("div",{staticClass:"d-flex justify-content-between text-secondary"},[e("small",[e("i",{staticClass:"far fa-calendar"}),t._v(" "+t._s(new Date(s.created_at).toLocaleString()))]),e("small",[e("i",{staticClass:"far fa-hand"}),t._v(" "+t._s(s.answers_count)+" ответов")])])],1)])})),t.links.length>3?e("nav",{staticClass:"pt-4"},[e("ul",{staticClass:"pagination justify-content-center"},t._l(t.links,(function(s,a){return e("li",{key:a,staticClass:"page-item",class:{disabled:!s.url,active:s.active}},[e("a",{staticClass:"page-link",attrs:{href:"#"},domProps:{innerHTML:t._s(s.label)},on:{click:function(e){return e.preventDefault(),t.loadQuestions(s.url)}}})])})),0)]):t._e()],2)])},f=[],h={name:"HomeView",data(){return{questions:[],links:[],loading:!0}},computed:(0,r.Se)(["user"]),methods:{loadQuestions:function(t="https://students.itschool.tou.edu.kz/surveys-backend/api/questions"){this.loading=!0,fetch(t,{headers:{Authorization:`Bearer ${this.user.api_token}`}}).then((t=>t.json())).then((t=>{this.questions=t.data,this.links=t.meta.links,this.loading=!1}))}},created(){this.loadQuestions()}},g=h,C=(0,c.Z)(g,v,f,!1,null,null,null),b=C.exports,_=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("main",{staticClass:"py-5"},[e("div",{staticClass:"container pt-5"},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-lg-6 col-sm-8"},[e("div",{staticClass:"card shadow"},[e("form",{staticClass:"card-body p-4",attrs:{action:"#"},on:{submit:function(s){return s.preventDefault(),t.login.apply(null,arguments)}}},[e("h2",{staticClass:"mb-5 text-center"},[t._v("Авторизация")]),e("div",{staticClass:"mb-4"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"form-control",class:{"is-invalid":t.errors.email||t.errors.error},attrs:{type:"email",placeholder:"Ваш email"},domProps:{value:t.form.email},on:{input:function(s){s.target.composing||t.$set(t.form,"email",s.target.value)}}}),e("span",{staticClass:"invalid-feedback"},[t._v(t._s(t.errors.email||t.errors.error))])]),e("div",{staticClass:"mb-4"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password,expression:"form.password"}],staticClass:"form-control",class:{"is-invalid":t.errors.password},attrs:{type:"password",placeholder:"Ваш пароль"},domProps:{value:t.form.password},on:{input:function(s){s.target.composing||t.$set(t.form,"password",s.target.value)}}}),e("span",{staticClass:"invalid-feedback"},[t._v(t._s(t.errors.password))])]),e("button",{staticClass:"btn w-100 mb-3",class:{"btn-primary":!t.loading,"btn-light":t.loading}},[t._v(" "+t._s(t.loading?"Вход...":"Войти")+" ")]),e("div",{staticClass:"text-center"},[e("small",[t._v(" Нет аккаунта? "),e("router-link",{attrs:{to:"/register"}},[t._v("Регистрация")])],1)])])])])])])])},y=[],w={name:"LoginView",data(){return{form:{email:"",password:""},errors:{},loading:!1}},methods:{login:function(){this.loading=!0,this.errors={},fetch("https://students.itschool.tou.edu.kz/surveys-backend/api/login",{method:"POST",body:JSON.stringify(this.form),headers:{"Content-Type":"application/json"}}).then((t=>t.json())).then((t=>{t.errors?this.errors=t.errors:(this.$store.commit("login",t.data),this.$router.push("/")),this.loading=!1}))}}},x=w,k=(0,c.Z)(x,_,y,!1,null,null,null),q=k.exports,$=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("main",{staticClass:"py-5"},[e("div",{staticClass:"container pt-5"},[e("div",{staticClass:"row justify-content-center"},[e("div",{staticClass:"col-lg-6 col-sm-8"},[e("div",{staticClass:"card shadow"},[e("form",{staticClass:"card-body p-4",attrs:{action:"index.html"},on:{submit:function(s){return s.preventDefault(),t.register.apply(null,arguments)}}},[e("h2",{staticClass:"mb-5 text-center"},[t._v("Регистрация")]),e("div",{staticClass:"mb-4"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"form-control",class:{"is-invalid":t.errors.name},attrs:{type:"name",placeholder:"Ваше имя"},domProps:{value:t.form.name},on:{input:function(s){s.target.composing||t.$set(t.form,"name",s.target.value)}}}),e("span",{staticClass:"invalid-feedback"},[t._v(t._s(t.errors.name))])]),e("div",{staticClass:"mb-4"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.email,expression:"form.email"}],staticClass:"form-control",class:{"is-invalid":t.errors.email},attrs:{type:"email",placeholder:"Ваш email"},domProps:{value:t.form.email},on:{input:function(s){s.target.composing||t.$set(t.form,"email",s.target.value)}}}),e("span",{staticClass:"invalid-feedback"},[t._v(t._s(t.errors.email))])]),e("div",{staticClass:"mb-4"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password,expression:"form.password"}],staticClass:"form-control",class:{"is-invalid":t.errors.password},attrs:{type:"password",placeholder:"Придумайте пароль"},domProps:{value:t.form.password},on:{input:function(s){s.target.composing||t.$set(t.form,"password",s.target.value)}}}),e("span",{staticClass:"invalid-feedback"},[t._v(t._s(t.errors.password))])]),e("button",{staticClass:"btn w-100 mb-3",class:{"btn-primary":!t.loading,"btn-light":t.loading}},[t._v(" "+t._s(t.loading?"Проверка...":"Создать аккаунт")+" ")]),e("div",{staticClass:"text-center"},[e("small",[t._v(" Уже зарегистрированы? "),e("router-link",{attrs:{to:"/login"}},[t._v("Войти")])],1)])])])])])])])},j=[],S={name:"RegisterView",data(){return{form:{name:"",email:"",password:""},errors:{},loading:!1}},methods:{register:function(){this.loading=!0,this.errors={},fetch("https://students.itschool.tou.edu.kz/surveys-backend/api/register",{method:"POST",body:JSON.stringify(this.form),headers:{"Content-Type":"application/json"}}).then((t=>t.json())).then((t=>{t.errors?this.errors=t.errors:(this.$store.commit("login",t.data),this.$router.push("/")),this.loading=!1}))}}},O=S,N=(0,c.Z)(O,$,j,!1,null,null,null),P=N.exports,T=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("main",{staticClass:"py-5"},[e("div",{staticClass:"container"},[t.question?e("div",{staticClass:"card shadow"},[e("form",{staticClass:"card-body p-4",attrs:{action:"#"},on:{submit:function(s){return s.preventDefault(),t.send.apply(null,arguments)}}},[e("div",{staticClass:"d-sm-flex align-items-center justify-content-between"},[e("h2",{staticClass:"mb-3 mb-sm-0"},[t._v(t._s(t.question.text))]),e("small",{staticClass:"text-secondary"},[e("i",{staticClass:"far fa-user-circle"}),t._v(" "+t._s(t.question.user.name)+", "+t._s(new Date(t.question.created_at).toLocaleString()))])]),e("hr",{staticClass:"my-4"}),t._l(t.question.variants,(function(s){return e("label",{key:s.id,staticClass:"mb-3 d-block"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.variant_id,expression:"variant_id"}],staticClass:"me-2",attrs:{type:"radio",name:"variant_id"},domProps:{value:s.id,checked:t._q(t.variant_id,s.id)},on:{change:function(e){t.variant_id=s.id}}}),t._v(" "+t._s(s.text)+" ")])})),e("hr"),e("div",{staticClass:"d-flex justify-content-between align-items-center"},[e("div",{staticClass:"d-flex align-items-center"},[e("button",{staticClass:"btn btn-primary",attrs:{disabled:!t.variant_id}},[t._v("Ответить")]),t.loading?e("div",{staticClass:"loader-sm ms-3"}):t._e()]),e("small",{staticClass:"text-secondary"},[e("i",{staticClass:"far fa-hand"}),t._v(" "+t._s(t.question.answers_count)+" ответов")])])],2)]):t._e()])])},Z=[],z={name:"QuestionView",props:["id"],computed:(0,r.Se)(["user"]),data(){return{question:null,variant_id:null,loading:!1}},methods:{loadQuestion:function(){fetch(`https://students.itschool.tou.edu.kz/surveys-backend/api/questions/${this.id}`,{headers:{Authorization:`Bearer ${this.user.api_token}`}}).then((t=>t.json())).then((t=>this.question=t.data))},send:function(){this.loading=!0,fetch(`https://students.itschool.tou.edu.kz/surveys-backend/api/questions/${this.id}/answer`,{method:"POST",body:JSON.stringify({variant_id:this.variant_id}),headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.user.api_token}`}}).then((t=>{t.ok&&this.$router.push(`/results/${this.id}`),this.loading=!1}))}},created(){this.loadQuestion()}},D=z,A=(0,c.Z)(D,T,Z,!1,null,null,null),E=A.exports,V=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("main",{staticClass:"py-5"},[e("div",{staticClass:"container"},[t.loading?e("div",{staticClass:"d-flex justify-content-center py-4"},[e("div",{staticClass:"loader"})]):t._e(),t.question?e("div",{staticClass:"card shadow"},[e("div",{staticClass:"card-body p-4"},[e("div",{staticClass:"d-sm-flex align-items-center justify-content-between"},[e("h2",{staticClass:"mb-3 mb-sm-0"},[t._v(t._s(t.question.text))]),e("small",{staticClass:"text-secondary"},[e("i",{staticClass:"far fa-user-circle"}),t._v(" "+t._s(t.question.user.name)+", "+t._s(new Date(t.question.created_at).toLocaleString()))])]),e("hr",{staticClass:"my-4"}),t._l(t.question.variants,(function(s){return e("div",{key:s.id,staticClass:"mb-4"},[e("div",{staticClass:"mb-2"},[t._v(t._s(s.text)+" - "+t._s(t.percent(s.users.length))+"%")]),e("div",{staticClass:"progress"},[e("div",{staticClass:"progress-bar",style:{width:t.percent(s.users.length)+"%"},attrs:{role:"progressbar","aria-valuenow":t.percent(s.users.length),"aria-valuemin":"0","aria-valuemax":"100"}})]),e("small",{staticClass:"text-secondary"},[t._v(" "+t._s(s.users.slice(0,3).map((function(t){return t.name})).join(", "))+" "),s.users.length>3?e("span",[t._v("и еще "+t._s(s.users.length-3))]):t._e()])])})),e("hr"),e("router-link",{staticClass:"btn btn-sm btn-light",attrs:{to:"/question/"+t.id}},[e("i",{staticClass:"fas fa-pencil"}),t._v(" Изменить свой ответ ")])],2)]):t._e()])])},B=[],J={name:"ResultsView",props:["id"],computed:{...(0,r.Se)(["user"]),allAnswers:function(){return this.question.variants.reduce(((t,s)=>t.concat(s.users)),[])}},data(){return{question:null,loading:!0}},methods:{percent:function(t){return t?Math.round(t/this.allAnswers.length*100):0},loadResults:function(){fetch(`https://students.itschool.tou.edu.kz/surveys-backend/api/questions/${this.id}/results`,{headers:{Authorization:`Bearer ${this.user.api_token}`}}).then((t=>t.json())).then((t=>{t.errors?this.$router.push(`/question/${this.id}`):this.question=t.data,this.loading=!1}))}},created(){this.loadResults()}},Q=J,I=(0,c.Z)(Q,V,B,!1,null,null,null),L=I.exports,R=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("main",{staticClass:"py-5"},[e("div",{staticClass:"container"},[e("div",{staticClass:"card shadow"},[e("form",{staticClass:"card-body p-4",attrs:{action:"#"},on:{submit:function(s){return s.preventDefault(),t.send.apply(null,arguments)}}},[e("h2",{staticClass:"mb-4"},[t._v("Новый опрос")]),e("div",{staticClass:"mb-4"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.question.text,expression:"question.text"}],staticClass:"form-control",class:{"is-invalid":t.errors.text},attrs:{placeholder:"Текст вопроса"},domProps:{value:t.question.text},on:{input:function(s){s.target.composing||t.$set(t.question,"text",s.target.value)}}}),e("span",{staticClass:"invalid-feedback"},[t._v("This field is required")])]),t._l(t.question.variants,(function(s,a){return e("div",{key:a,staticClass:"mb-4 row"},[e("div",{staticClass:"col"},[e("input",{directives:[{name:"model",rawName:"v-model",value:s.text,expression:"variant.text"}],staticClass:"form-control",class:{"is-invalid":t.errors["variants."+a+".text"]},attrs:{type:"text",placeholder:"Вариант #"+(a+1)},domProps:{value:s.text},on:{input:function(e){e.target.composing||t.$set(s,"text",e.target.value)}}}),e("span",{staticClass:"invalid-feedback"},[t._v("This field is required")])]),e("div",{staticClass:"col-auto"},[e("button",{staticClass:"btn btn-light",attrs:{type:"button"},on:{click:function(s){return t.deleteVariant(a)}}},[e("i",{staticClass:"fas fa-trash-alt"})])])])})),e("a",{staticClass:"btn btn-light",attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),t.addVariant.apply(null,arguments)}}},[e("i",{staticClass:"fas fa-add"}),t._v(" Добавить вариант ответа ")]),e("hr"),e("div",{staticClass:"d-flex justify-content-end align-items-center"},[t.loading?e("div",{staticClass:"loader-sm me-3"}):t._e(),e("button",{staticClass:"btn btn-primary"},[t._v("Опубликовать")])])],2)])])])},F=[],M={name:"CreateView",data(){return{question:{variants:[{text:""}]},errors:{},loading:!1}},computed:(0,r.Se)(["user"]),methods:{addVariant:function(){this.question.variants.push({text:""})},deleteVariant:function(t){this.question.variants.splice(t,1)},send:function(){this.loading=!0,this.errors={},fetch("https://students.itschool.tou.edu.kz/surveys-backend/api/questions",{method:"POST",body:JSON.stringify(this.question),headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.user.api_token}`}}).then((t=>{t.ok?this.$router.push("/"):t.json().then((t=>this.errors=t.errors)),this.loading=!1}))}}},U=M,H=(0,c.Z)(U,R,F,!1,null,null,null),G=H.exports;a.Z.use(p.Z);const K=[{path:"/",name:"home",component:b},{path:"/login",name:"login",component:q},{path:"/register",name:"register",component:P},{path:"/question/:id",name:"question",component:E,props:!0},{path:"/results/:id",name:"results",component:L,props:!0},{path:"/create",name:"create",component:G}],W=new p.Z({mode:"history",base:"/surveys-frontend/",routes:K});W.beforeEach(((t,s,e)=>{localStorage.getItem("user")||["login","register"].includes(t.name)?e():e({name:"login"})}));var X=W;a.Z.use(r.ZP);var Y=new r.ZP.Store({state:{user:null},getters:{user(t){return t.user}},mutations:{login(t,s){t.user=s,localStorage.setItem("user",JSON.stringify(s))},logout(t){t.user=null,localStorage.removeItem("user")},restoreUser(t){localStorage.getItem("user")&&(t.user=JSON.parse(localStorage.getItem("user")))}},actions:{},modules:{}});a.Z.config.productionTip=!1,new a.Z({router:X,store:Y,render:t=>t(d)}).$mount("#app")}},s={};function e(a){var n=s[a];if(void 0!==n)return n.exports;var i=s[a]={exports:{}};return t[a](i,i.exports,e),i.exports}e.m=t,function(){var t=[];e.O=function(s,a,n,i){if(!a){var r=1/0;for(u=0;u<t.length;u++){a=t[u][0],n=t[u][1],i=t[u][2];for(var o=!0,l=0;l<a.length;l++)(!1&i||r>=i)&&Object.keys(e.O).every((function(t){return e.O[t](a[l])}))?a.splice(l--,1):(o=!1,i<r&&(r=i));if(o){t.splice(u--,1);var c=n();void 0!==c&&(s=c)}}return s}i=i||0;for(var u=t.length;u>0&&t[u-1][2]>i;u--)t[u]=t[u-1];t[u]=[a,n,i]}}(),function(){e.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(s,{a:s}),s}}(),function(){e.d=function(t,s){for(var a in s)e.o(s,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:s[a]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)}}(),function(){var t={143:0};e.O.j=function(s){return 0===t[s]};var s=function(s,a){var n,i,r=a[0],o=a[1],l=a[2],c=0;if(r.some((function(s){return 0!==t[s]}))){for(n in o)e.o(o,n)&&(e.m[n]=o[n]);if(l)var u=l(e)}for(s&&s(a);c<r.length;c++)i=r[c],e.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return e.O(u)},a=self["webpackChunkdev_surveys_frontend"]=self["webpackChunkdev_surveys_frontend"]||[];a.forEach(s.bind(null,0)),a.push=s.bind(null,a.push.bind(a))}();var a=e.O(void 0,[998],(function(){return e(9813)}));a=e.O(a)})();
//# sourceMappingURL=app.39f3a9e6.js.map